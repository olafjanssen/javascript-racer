var network = new brain.NeuralNetwork();
console.log('load net');
// network.fromJSON({"sizes":[8,4,8],"layers":[{"p":{},"s":{},"c0":{},"c1":{},"c2":{},"c3":{},"c4":{},"c5":{}},{"0":{"bias":-41.857784271240234,"weights":{"p":4.013337135314941,"s":-60.70561599731445,"c0":-3.6765081882476807,"c1":36.17647171020508,"c2":34.062767028808594,"c3":28.90351104736328,"c4":-9.108397483825684,"c5":-19.945316314697266}},"1":{"bias":17.46889877319336,"weights":{"p":-54.44768142700195,"s":-7.029297828674316,"c0":25.486236572265625,"c1":28.15260887145996,"c2":-36.89366149902344,"c3":-31.601882934570312,"c4":-18.434490203857422,"c5":14.615462303161621}},"2":{"bias":59.159061431884766,"weights":{"p":-5.973048210144043,"s":-65.28919982910156,"c0":-7.33472204208374,"c1":-10.304258346557617,"c2":3.228652000427246,"c3":3.6554384231567383,"c4":-8.25295639038086,"c5":-10.477980613708496}},"3":{"bias":72.77496337890625,"weights":{"p":-88.16983032226562,"s":-4.737884521484375,"c0":2.383300542831421,"c1":-21.192928314208984,"c2":-36.7635498046875,"c3":-12.035444259643555,"c4":12.466187477111816,"c5":10.91055679321289}}},{"o":{"bias":-8.170392036437988,"weights":{"0":2.818308115005493,"1":-1.5950112342834473,"2":1.9486093521118164,"3":-1.8841514587402344}},"of":{"bias":0.17937761545181274,"weights":{"0":3.527111053466797,"1":1.3391573429107666,"2":-4.428905010223389,"3":-1.9353342056274414}},"olf":{"bias":-0.5605315566062927,"weights":{"0":1.2787401676177979,"1":4.015944004058838,"2":0.646138072013855,"3":-2.056727409362793}},"orf":{"bias":-1.9204061031341553,"weights":{"0":-7.2229413986206055,"1":-52.79169464111328,"2":4.1427788734436035,"3":1.281215786933899}},"or":{"bias":-4.50590181350708,"weights":{"0":-10.09264087677002,"1":-2.29398775100708,"2":-0.2655971050262451,"3":4.137205123901367}},"ors":{"bias":-6.2168049812316895,"weights":{"0":-1.3429006338119507,"1":-1.678904414176941,"2":-1.1373871564865112,"3":0.8268014788627625}},"ol":{"bias":-4.624190807342529,"weights":{"0":-0.3131209909915924,"1":5.814070701599121,"2":0.4273788034915924,"3":-3.542915105819702}},"ols":{"bias":-6.454771518707275,"weights":{"0":-3.7763116359710693,"1":-0.12073224782943726,"2":1.5515481233596802,"3":2.100795269012451}}}],"outputLookup":true,"inputLookup":true,"activation":"sigmoid","trainOpts":{"iterations":20000,"errorThresh":0.005,"log":false,"logPeriod":10,"learningRate":0.3,"momentum":0.1,"callbackPeriod":10}});
// console.log('net loaded');


// network.fromJSON({"sizes":[8,4,8],"layers":[{"p":{},"s":{},"c0":{},"c1":{},"c2":{},"c3":{},"c4":{},"c5":{}},{"0":{"bias":9.048269271850586,"weights":{"p":-60.652000427246094,"s":-13.00747299194336,"c0":14.605716705322266,"c1":-13.65689754486084,"c2":-27.45472526550293,"c3":0.6046314835548401,"c4":37.81608581542969,"c5":6.433130264282227}},"1":{"bias":-48.78893280029297,"weights":{"p":108.41112518310547,"s":-21.30424690246582,"c0":16.413042068481445,"c1":65.49845123291016,"c2":-27.584503173828125,"c3":-31.2525634765625,"c4":-7.198963642120361,"c5":-23.287883758544922}},"2":{"bias":-5.534716606140137,"weights":{"p":36.03865051269531,"s":-3.5238242149353027,"c0":-2.50166392326355,"c1":0.8181294202804565,"c2":4.777900218963623,"c3":5.500842094421387,"c4":0.7602781057357788,"c5":-16.550365447998047}},"3":{"bias":13.350581169128418,"weights":{"p":84.53163146972656,"s":-0.935970664024353,"c0":3.295696973800659,"c1":-7.0091328620910645,"c2":-32.392845153808594,"c3":-31.148008346557617,"c4":-7.432561874389648,"c5":-2.445514440536499}}},{"o":{"bias":-6.926961898803711,"weights":{"0":1.3965684175491333,"1":0.2254917472600937,"2":0.4236668646335602,"3":2.071948289871216}},"of":{"bias":0.09758072346448898,"weights":{"0":-1.689853310585022,"1":-3.0089175701141357,"2":0.7875725030899048,"3":-29.83475112915039}},"olf":{"bias":-0.7421216368675232,"weights":{"0":-42.79646682739258,"1":2.123380661010742,"2":-0.04409153014421463,"3":20.547521591186523}},"orf":{"bias":-1.7307610511779785,"weights":{"0":1.2207437753677368,"1":1.8210946321487427,"2":-1.8955976963043213,"3":-10.275732040405273}},"or":{"bias":-2.8995795249938965,"weights":{"0":2.753124713897705,"1":-1.3455718755722046,"2":-29.408828735351562,"3":6.49976921081543}},"ol":{"bias":-18.72235679626465,"weights":{"0":-24.107473373413086,"1":7.835142135620117,"2":-12.551359176635742,"3":19.54251480102539}},"ors":{"bias":-21.293903350830078,"weights":{"0":19.80928611755371,"1":-3.645332098007202,"2":-9.898777961730957,"3":-5.5046257972717285}},"ofs":{"bias":-6.965619087219238,"weights":{"0":-2.031193971633911,"1":-1.4191334247589111,"2":-1.715321660041809,"3":-1.7021056413650513}}}],"outputLookup":true,"inputLookup":true,"activation":"sigmoid","trainOpts":{"iterations":20000,"errorThresh":0.005,"log":false,"logPeriod":10,"learningRate":0.3,"momentum":0.1,"callbackPeriod":10}});

// network.fromJSON({"sizes":[8,20,8],"layers":[{"p":{},"s":{},"c0":{},"c1":{},"c2":{},"c3":{},"c4":{},"c5":{}},{"0":{"bias":5.899790287017822,"weights":{"p":-26.142419815063477,"s":-12.0439453125,"c0":-1.1190519332885742,"c1":-5.035231590270996,"c2":-1.849557638168335,"c3":0.6725379824638367,"c4":12.71096420288086,"c5":6.329964637756348}},"1":{"bias":0.7098954916000366,"weights":{"p":20.365331649780273,"s":-15.582992553710938,"c0":9.916791915893555,"c1":9.204806327819824,"c2":-5.607384204864502,"c3":-8.410466194152832,"c4":-8.341752052307129,"c5":1.0783993005752563}},"2":{"bias":-0.3129675090312958,"weights":{"p":-0.8558828234672546,"s":0.4217730760574341,"c0":1.090211272239685,"c1":-2.688939094543457,"c2":-1.4311072826385498,"c3":0.38318756222724915,"c4":-8.83242130279541,"c5":4.946621894836426}},"3":{"bias":0.7159460186958313,"weights":{"p":3.857099771499634,"s":-6.559506416320801,"c0":0.2741912305355072,"c1":8.70878791809082,"c2":-15.475778579711914,"c3":-11.452265739440918,"c4":2.1977596282958984,"c5":14.868695259094238}},"4":{"bias":-1.4028090238571167,"weights":{"p":7.034427642822266,"s":-5.984016418457031,"c0":6.033967971801758,"c1":0.910697877407074,"c2":-9.419733047485352,"c3":-1.2564630508422852,"c4":-4.824342250823975,"c5":7.388729095458984}},"5":{"bias":2.697080373764038,"weights":{"p":2.6408283710479736,"s":-18.483842849731445,"c0":8.33081340789795,"c1":6.2712788581848145,"c2":1.333537220954895,"c3":4.428910255432129,"c4":-6.459949970245361,"c5":-0.8677674531936646}},"6":{"bias":-0.5463002324104309,"weights":{"p":6.372479438781738,"s":-8.425390243530273,"c0":9.782134056091309,"c1":-1.409880518913269,"c2":-1.5432343482971191,"c3":-2.3206634521484375,"c4":-0.32800915837287903,"c5":-4.373939514160156}},"7":{"bias":-7.587256908416748,"weights":{"p":17.672378540039062,"s":8.191665649414062,"c0":0.4780295789241791,"c1":4.805673599243164,"c2":-1.1858230829238892,"c3":-15.432138442993164,"c4":4.033019542694092,"c5":-6.854614734649658}},"8":{"bias":13.610761642456055,"weights":{"p":-4.5049519538879395,"s":-28.087936401367188,"c0":13.166657447814941,"c1":4.961071014404297,"c2":-4.999094486236572,"c3":-4.131770133972168,"c4":-1.3638741970062256,"c5":1.5460708141326904}},"9":{"bias":-1.2181583642959595,"weights":{"p":8.71862506866455,"s":-1.26730215549469,"c0":1.9560350179672241,"c1":0.7291737198829651,"c2":-12.027824401855469,"c3":-2.2223563194274902,"c4":2.26393985748291,"c5":2.5587666034698486}},"10":{"bias":9.435745239257812,"weights":{"p":-24.12767219543457,"s":-37.381134033203125,"c0":15.04942798614502,"c1":-0.9416815638542175,"c2":-4.486464500427246,"c3":11.46247673034668,"c4":0.6648561954498291,"c5":12.66529655456543}},"11":{"bias":1.89566969871521,"weights":{"p":14.839664459228516,"s":-5.341352462768555,"c0":4.008757591247559,"c1":-3.029366970062256,"c2":-1.416567325592041,"c3":4.29442834854126,"c4":-8.684270858764648,"c5":-3.614907741546631}},"12":{"bias":0.07328786700963974,"weights":{"p":12.27586841583252,"s":-9.36083984375,"c0":7.688608169555664,"c1":1.6392408609390259,"c2":2.6464016437530518,"c3":-3.5322425365448,"c4":-5.747711658477783,"c5":-3.6233224868774414}},"13":{"bias":0.9559096693992615,"weights":{"p":34.144100189208984,"s":-22.099193572998047,"c0":0.19912223517894745,"c1":5.761502742767334,"c2":-7.444416046142578,"c3":-3.8503217697143555,"c4":2.0077481269836426,"c5":4.595173358917236}},"14":{"bias":-1.7809152603149414,"weights":{"p":12.279383659362793,"s":5.813461780548096,"c0":4.2121195793151855,"c1":-2.0321309566497803,"c2":-16.959999084472656,"c3":-2.740314483642578,"c4":2.4141478538513184,"c5":-0.7778084874153137}},"15":{"bias":-1.4282729625701904,"weights":{"p":6.902276992797852,"s":-13.57594108581543,"c0":1.531145691871643,"c1":-2.854649543762207,"c2":-4.864958763122559,"c3":6.223649501800537,"c4":1.2220165729522705,"c5":4.443563461303711}},"16":{"bias":-1.3626205921173096,"weights":{"p":17.65990447998047,"s":7.233470439910889,"c0":-2.687870979309082,"c1":-9.51211166381836,"c2":-11.6829833984375,"c3":-0.9255366921424866,"c4":-1.8511394262313843,"c5":3.645805835723877}},"17":{"bias":-5.529313564300537,"weights":{"p":16.663902282714844,"s":-10.259535789489746,"c0":-0.4976601302623749,"c1":3.217055082321167,"c2":1.8238202333450317,"c3":5.195950984954834,"c4":-2.976285696029663,"c5":-4.437363147735596}},"18":{"bias":-0.7464510202407837,"weights":{"p":7.474655628204346,"s":-6.469186305999756,"c0":4.889444828033447,"c1":-0.33472415804862976,"c2":-2.417520046234131,"c3":-1.8013578653335571,"c4":-8.258090019226074,"c5":6.228643417358398}},"19":{"bias":-0.25720691680908203,"weights":{"p":22.29144287109375,"s":-34.324745178222656,"c0":-0.7213397026062012,"c1":3.388988971710205,"c2":2.5946037769317627,"c3":14.601160049438477,"c4":0.3936046361923218,"c5":3.8962059020996094}}},{"o":{"bias":-5.994751453399658,"weights":{"0":-0.7567659616470337,"1":-0.6128025054931641,"2":-0.8590156435966492,"3":-0.7854317426681519,"4":-0.7136348485946655,"5":-0.8501020073890686,"6":-1.0076844692230225,"7":-1.0343763828277588,"8":-1.100221872329712,"9":-0.9636075496673584,"10":-0.9245550036430359,"11":-0.8891622424125671,"12":-1.0717984437942505,"13":-0.6497394442558289,"14":-0.8171874284744263,"15":-0.8919535875320435,"16":-0.8576782941818237,"17":-1.3756239414215088,"18":-0.9402317404747009,"19":-1.1371389627456665}},"of":{"bias":1.0653655529022217,"weights":{"0":-6.283170223236084,"1":-1.9111493825912476,"2":3.693603754043579,"3":-4.414628028869629,"4":-6.131164073944092,"5":-0.7565679550170898,"6":-8.408112525939941,"7":1.8623008728027344,"8":3.198312520980835,"9":4.48583459854126,"10":-1.7723925113677979,"11":-0.28640076518058777,"12":-0.1532740443944931,"13":0.47121283411979675,"14":3.7748312950134277,"15":4.8891472816467285,"16":-2.29315447807312,"17":-1.880536675453186,"18":-1.8004792928695679,"19":-1.0112743377685547}},"orf":{"bias":-2.680617094039917,"weights":{"0":2.9797308444976807,"1":-1.6444483995437622,"2":1.7745240926742554,"3":1.0733911991119385,"4":-3.080984592437744,"5":-0.0934591293334961,"6":-1.5355652570724487,"7":1.3289581537246704,"8":-2.544557571411133,"9":4.112097263336182,"10":0.8346244692802429,"11":0.7638698220252991,"12":1.5001544952392578,"13":0.30111366510391235,"14":-0.4883858561515808,"15":0.154144287109375,"16":-2.123645782470703,"17":-0.7942679524421692,"18":-1.0016177892684937,"19":-0.05284822732210159}},"olf":{"bias":-0.9018417000770569,"weights":{"0":-2.8246898651123047,"1":1.4175081253051758,"2":2.2228620052337646,"3":-1.7845686674118042,"4":0.8820165991783142,"5":-0.08829258382320404,"6":-1.1093906164169312,"7":-1.5971307754516602,"8":2.6334805488586426,"9":3.487971305847168,"10":-1.0985698699951172,"11":-2.824782609939575,"12":2.2429072856903076,"13":-0.6983497142791748,"14":-3.7044665813446045,"15":1.4926857948303223,"16":3.738635301589966,"17":-3.385075807571411,"18":-0.8726643323898315,"19":1.1642115116119385}},"or":{"bias":-4.630423545837402,"weights":{"0":-5.051236629486084,"1":-1.5400619506835938,"2":-2.7446255683898926,"3":0.2041153907775879,"4":-2.683323860168457,"5":3.163485288619995,"6":1.485917568206787,"7":-5.264721870422363,"8":-1.0915507078170776,"9":0.38525837659835815,"10":4.387192249298096,"11":6.565343379974365,"12":5.225338935852051,"13":-3.086754083633423,"14":-0.5107171535491943,"15":-3.550388813018799,"16":-3.389512538909912,"17":-5.753317832946777,"18":-6.341785907745361,"19":-2.6013853549957275}},"ors":{"bias":-5.919222831726074,"weights":{"0":-0.8986583948135376,"1":-0.8648961186408997,"2":-0.6884737014770508,"3":-1.0026965141296387,"4":-0.6991045475006104,"5":-0.5884551405906677,"6":-0.9221361875534058,"7":-0.9346089363098145,"8":-1.113754153251648,"9":-0.989781379699707,"10":-1.1323837041854858,"11":-0.7606027722358704,"12":-0.9933005571365356,"13":-0.6745589375495911,"14":-0.7013305425643921,"15":-1.1647069454193115,"16":-0.528925359249115,"17":-1.1171425580978394,"18":-0.8265435099601746,"19":-1.2457212209701538}},"ol":{"bias":-15.660822868347168,"weights":{"0":-4.321774005889893,"1":8.209653854370117,"2":-5.721975803375244,"3":-2.909874677658081,"4":2.340496063232422,"5":1.2324315309524536,"6":-2.8880231380462646,"7":-9.1268949508667,"8":-2.1272566318511963,"9":2.239122152328491,"10":-7.162125587463379,"11":1.2168971300125122,"12":1.2489107847213745,"13":-0.19151771068572998,"14":1.8593144416809082,"15":1.6193524599075317,"16":-3.9933152198791504,"17":-0.5159351229667664,"18":-4.246581077575684,"19":12.84676742553711}},"ols":{"bias":-6.31591796875,"weights":{"0":-0.8834977746009827,"1":-0.9126205444335938,"2":-1.0376559495925903,"3":-1.1535447835922241,"4":-0.8563743233680725,"5":-0.7403026819229126,"6":-1.157469630241394,"7":-1.0778794288635254,"8":-0.9348307847976685,"9":-1.1039929389953613,"10":-1.1945399045944214,"11":-0.9481460452079773,"12":-1.1225489377975464,"13":-0.6345083713531494,"14":-0.972334623336792,"15":-1.2730000019073486,"16":-0.5072165727615356,"17":-1.3260207176208496,"18":-1.0471563339233398,"19":-1.8381344079971313}}}],"outputLookup":true,"inputLookup":true,"activation":"sigmoid","trainOpts":{"iterations":2000,"errorThresh":0.005,"log":false,"logPeriod":10,"learningRate":0.3,"momentum":0.1,"callbackPeriod":10}});
//

network.fromJSON({"sizes":[8,10,5],"layers":[{"p":{},"s":{},"c0":{},"c1":{},"c2":{},"c3":{},"c4":{},"c5":{}},{"0":{"bias":1.8735005855560303,"weights":{"p":-30.60103416442871,"s":-9.741820335388184,"c0":2.168684959411621,"c1":2.1408252716064453,"c2":1.8827238082885742,"c3":2.076430320739746,"c4":2.1033191680908203,"c5":2.0556998252868652}},"1":{"bias":5.8918304443359375,"weights":{"p":6.262625217437744,"s":-51.777442932128906,"c0":6.5289998054504395,"c1":6.548539638519287,"c2":6.575838565826416,"c3":6.611293315887451,"c4":6.892138957977295,"c5":6.7175774574279785}},"2":{"bias":6.937791347503662,"weights":{"p":-95.719482421875,"s":-14.592963218688965,"c0":7.375522613525391,"c1":7.636517524719238,"c2":7.600130081176758,"c3":7.7310590744018555,"c4":7.583590507507324,"c5":7.5414018630981445}},"3":{"bias":3.62337327003479,"weights":{"p":-47.531463623046875,"s":-15.249738693237305,"c0":4.055714130401611,"c1":3.9905593395233154,"c2":4.113077163696289,"c3":4.1348981857299805,"c4":4.008432865142822,"c5":3.9772493839263916}},"4":{"bias":3.6921067237854004,"weights":{"p":-14.082921028137207,"s":-31.657878875732422,"c0":3.835505723953247,"c1":4.01672887802124,"c2":3.8390085697174072,"c3":3.7950236797332764,"c4":4.056519031524658,"c5":3.711280584335327}},"5":{"bias":1.2911146879196167,"weights":{"p":-20.935871124267578,"s":-4.6400933265686035,"c0":1.2350164651870728,"c1":1.1689356565475464,"c2":1.3949118852615356,"c3":1.2766269445419312,"c4":1.3281692266464233,"c5":1.2432538270950317}},"6":{"bias":4.166619777679443,"weights":{"p":68.40185546875,"s":-71.31351470947266,"c0":4.7447028160095215,"c1":4.784678936004639,"c2":4.973602771759033,"c3":4.657227993011475,"c4":4.80761194229126,"c5":4.630716800689697}},"7":{"bias":1.3799577951431274,"weights":{"p":-102.39128112792969,"s":63.29470443725586,"c0":1.7476534843444824,"c1":1.518690824508667,"c2":1.6603460311889648,"c3":1.5978784561157227,"c4":1.4548256397247314,"c5":1.458235263824463}},"8":{"bias":-3.102421522140503,"weights":{"p":-26.784082412719727,"s":31.22089958190918,"c0":-3.4515602588653564,"c1":-3.5864737033843994,"c2":-3.245964765548706,"c3":-3.2911946773529053,"c4":-3.3421666622161865,"c5":-3.430234670639038}},"9":{"bias":1.8963676691055298,"weights":{"p":-31.184412002563477,"s":-8.427725791931152,"c0":2.044412612915039,"c1":2.175708293914795,"c2":2.0549964904785156,"c3":2.1646928787231445,"c4":2.144726276397705,"c5":1.8610635995864868}}},{"o":{"bias":-5.03415584564209,"weights":{"0":-1.170837163925171,"1":-1.0779623985290527,"2":-1.5202418565750122,"3":-1.0379661321640015,"4":-1.2740461826324463,"5":-1.2066588401794434,"6":-1.492898941040039,"7":-2.3448500633239746,"8":-0.9895679950714111,"9":-1.1063356399536133}},"of":{"bias":-1.8045034408569336,"weights":{"0":-6.538400173187256,"1":-1.3102613687515259,"2":-2.21095609664917,"3":1.6676349639892578,"4":3.9738545417785645,"5":-0.9527072310447693,"6":-1.0292649269104004,"7":3.0007922649383545,"8":-1.2645102739334106,"9":-5.868056297302246}},"olf":{"bias":0.10306364297866821,"weights":{"0":-6.1857590675354,"1":0.11653361469507217,"2":0.8648819923400879,"3":-7.165369033813477,"4":-4.055104732513428,"5":-6.740386009216309,"6":1.92133629322052,"7":-1.736220359802246,"8":5.135157585144043,"9":-11.80750846862793}},"orf":{"bias":-13.683623313903809,"weights":{"0":2.825354814529419,"1":0.31402352452278137,"2":1.6977009773254395,"3":2.185062885284424,"4":-2.138493537902832,"5":-0.6451731324195862,"6":0.07958848774433136,"7":11.00253963470459,"8":0.6856688857078552,"9":-1.8409372568130493}},"or":{"bias":-17.00635528564453,"weights":{"0":-3.2758052349090576,"1":0.9026365876197815,"2":30.27090835571289,"3":-7.73748254776001,"4":-2.0070905685424805,"5":2.62091326713562,"6":-20.25410270690918,"7":-13.887740135192871,"8":-12.496316909790039,"9":-1.581558108329773}}}],"outputLookup":true,"inputLookup":true,"activation":"sigmoid","trainOpts":{"iterations":20000,"errorThresh":0.005,"log":false,"logPeriod":10,"learningRate":0.3,"momentum":0.1,"callbackPeriod":10}});

// var network = new brain.NeuralNetwork({
//     hiddenLayers: [20]
// });
//
// var trainingSet = [
//     {input: {p: 0, s: 0, c0: 1, c1: 1, c2: 1, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//     {input: {p: 0.25, s: 0, c0: 1, c1: 1, c2: 1, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//     {input: {p: 0.45, s: 0, c0: 1, c1: 1, c2: 1, c3: 1, c4: 1, c5: 1}, output: {of: 1}},
//     {input: {p: 0.55, s: 0, c0: 1, c1: 1, c2: 1, c3: 1, c4: 1, c5: 1}, output: {of: 1}},
//     {input: {p: 0.75, s: 0, c0: 1, c1: 1, c2: 1, c3: 1, c4: 1, c5: 1}, output: {olf: 1}},
//     {input: {p: 1, s: 0, c0: 1, c1: 1, c2: 1, c3: 1, c4: 1, c5: 1}, output: {olf: 1}},
//
//     {input: {p: 0, s: 0, c0: 1, c1: 0, c2: 1, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//     {input: {p: 0.25, s: 0, c0: 1, c1: 0, c2: 1, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//     {input: {p: 0.45, s: 0, c0: 1, c1: 0, c2: 1, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//     {input: {p: 0.55, s: 0, c0: 1, c1: 0, c2: 1, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//     {input: {p: 0.75, s: 0, c0: 1, c1: 0, c2: 1, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//     {input: {p: 1, s: 0, c0: 1, c1: 0, c2: 1, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//
//     {input: {p: 0, s: 0, c0: 1, c1: 1, c2: 0, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//     {input: {p: 0.25, s: 0, c0: 1, c1: 1, c2: 0, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//     {input: {p: 0.45, s: 0, c0: 1, c1: 1, c2: 0, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//     {input: {p: 0.55, s: 0, c0: 1, c1: 1, c2: 0, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//     {input: {p: 0.75, s: 0, c0: 1, c1: 1, c2: 0, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//     {input: {p: 1, s: 0, c0: 1, c1: 1, c2: 0, c3: 1, c4: 1, c5: 1}, output: {orf: 1}},
//
//     {input: {p: 0, s: 0, c0: 1, c1: 1, c2: 1, c3: 0, c4: 1, c5: 1}, output: {olf: 1}},
//     {input: {p: 0.25, s: 0, c0: 1, c1: 1, c2: 1, c3: 0, c4: 1, c5: 1}, output: {olf: 1}},
//     {input: {p: 0.45, s: 0, c0: 1, c1: 1, c2: 1, c3: 0, c4: 1, c5: 1}, output: {olf: 1}},
//     {input: {p: 0.55, s: 0, c0: 1, c1: 1, c2: 1, c3: 0, c4: 1, c5: 1}, output: {olf: 1}},
//     {input: {p: 0.75, s: 0, c0: 1, c1: 1, c2: 1, c3: 0, c4: 1, c5: 1}, output: {olf: 1}},
//     {input: {p: 1, s: 0, c0: 1, c1: 1, c2: 1, c3: 0, c4: 1, c5: 1}, output: {olf: 1}},
//
//     {input: {p: 0, s: 0, c0: 1, c1: 1, c2: 1, c3: 1, c4: 0, c5: 1}, output: {olf: 1}},
//     {input: {p: 0.25, s: 0, c0: 1, c1: 1, c2: 1, c3: 1, c4: 0, c5: 1}, output: {olf: 1}},
//     {input: {p: 0.45, s: 0, c0: 1, c1: 1, c2: 1, c3: 1, c4: 0, c5: 1}, output: {olf: 1}},
//     {input: {p: 0.55, s: 0, c0: 1, c1: 1, c2: 1, c3: 1, c4: 0, c5: 1}, output: {olf: 1}},
//     {input: {p: 0.75, s: 0, c0: 1, c1: 1, c2: 1, c3: 1, c4: 0, c5: 1}, output: {olf: 1}},
//     {input: {p: 1, s: 0, c0: 1, c1: 1, c2: 1, c3: 1, c4: 0, c5: 1}, output: {olf: 1}}
//
// ];
//
// console.log('start training');
// network.train(trainingSet, {
//     iterations: 2000,
//     // learningRate: 0.8,
//     callback: function (aap) {
//         console.log(aap);
//     }
// });

/**
 * name: brain-agent
 *
 * Full control agent: takes its x position on the road and its own speed as input and allows left, neutral and right with full throttle, neutral and braking.
 * Reward is speed of car.
 *
 * Bigger brain to compensate for more output nodes.
 *
 * Only is active every 6 frames, which means action and reward is taken across 100ms.
 */

var Agent = function (environment) {
    var tick = 0;
    var episode = 0;
    var maxEpisodes = 20;
    var stats = [];
    var interval = 6;

    this.update = function () {
        if (tick % interval === 0) {
            // activate the neural network
            var result = brain.likely(environment.getInputState(), network);
            console.log(result);
            environment.performAction(result);
        }
        tick++;
    };

    this.episodeEnd = function () {
        episode++;
        if (episode === maxEpisodes) {
            console.log('end!!!');
            downloadObjectAsJson(stats, environment.getName() + '_episode_stats');
        }
    };

};

function downloadObjectAsJson(exportObj, exportName) {
    var dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(exportObj));
    var downloadAnchorNode = document.createElement('a');
    downloadAnchorNode.setAttribute("href", dataStr);
    downloadAnchorNode.setAttribute("download", exportName + ".json");
    downloadAnchorNode.click();
    downloadAnchorNode.remove();
}

var Environment = function (game) {

    function getName() {
        return 'brain-agent';
    }

    function performAction(action) {

        game.keyLeft = false;
        game.keyRight = false;
        game.keyFaster = false;
        game.keySlower = false;

        for (var c in action) {
            switch (action[c]) {
                case 'l':
                    game.keyLeft = true;
                    break;
                case 'r':
                    game.keyRight = true;
                    break;
                case 'f':
                    game.keyFaster = true;
                    break;
                case 's':
                    game.keySlower = true;
                    break;
                default:

            }
        }
    }

    function getInputState() {
        var states = {p: (game.playerX + 2) / 4, s: game.speed / game.maxSpeed};

        var carsahead = !game.cars ? [] : game.cars.filter(function (c) {
            return (c.z > game.position + game.playerZ) && (c.z < game.position + game.playerZ + 10 * segmentLength);
        });

        for (var i = 0; i < 6; i++) {
            var car = carsahead.find(function (c) {
                return (c.offset - game.playerX > -0.75 + i * 0.25) && (c.offset - game.playerX < -0.75 + (i + 1) * 0.25);
            });
            if (car === undefined) {
                states['c' + i] = 1;
            } else {
                states['c' + i] = (car.z - (game.position + game.playerZ)) / (10 * segmentLength);
            }
        }
        return states;
    }

    return {
        performAction: performAction,
        getInputState: getInputState,
        getName: getName
    }
};

var environment = new Environment(window);
var agent = new Agent(environment);
